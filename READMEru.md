# DataSheet Parser

Инструмент для оцифровки технической документации (даташитов) с помощью мультимодальных моделей ИИ.

## Описание

Данный проект предназначен для автоматической оцифровки PDF документов с технической документацией. Процесс включает:
1. Разделение PDF файла на отдельные страницы-изображения
2. Последовательную обработку страниц с помощью мультимодальной модели ИИ через OpenAI API
3. Опциональный перевод содержимого на указанный язык
4. Сохранение результатов в структурированном Markdown формате

## Установка

```bash
pip install -r requirements.txt
```

### Установка Poppler (обязательно)

Для работы с PDF требуется установить Poppler:

#### Windows:
1. Скачайте последнюю версию с [GitHub](https://github.com/oschwartz10612/poppler-windows/releases/)
2. Распакуйте архив в удобную директорию (например, `C:\Poppler`)
3. Добавьте путь к папке bin в переменную PATH:
   - Временно в текущем сеансе PowerShell: `$env:PATH += ";C:\Poppler\Library\bin"`
   - Или постоянно через "Параметры системы" → "Переменные среды"

#### Linux:
```bash
apt-get install poppler-utils
```

#### macOS:
```bash
brew install poppler
```

## Использование

1. Создайте файл `.env` с вашим API ключом OpenAI:
```
OPENAI_API_KEY=your_api_key_here
```

2. Запустите скрипт:
```bash
# Базовое использование - извлечение контента на языке оригинала
python datasheet_parser.py path_to_pdf_file.pdf

# Извлечение и перевод контента
python datasheet_parser.py path_to_pdf_file.pdf --translate --target-language "Russian"

# Расширенное использование с несколькими опциями
python datasheet_parser.py path_to_pdf_file.pdf \
    --translate --target-language "German" \
    --model "gpt-4o" \
    --poppler-path "C:\Poppler\Library\bin" \
    --output "translated_docs"
```

### Доступные модели

По умолчанию используется модель `gpt-4o`. Также можно использовать:
- `gpt-4-vision-preview` - предыдущая версия мультимодальной модели
- Другие модели OpenAI с поддержкой анализа изображений

### Дополнительные опции

```
--output (-o) - Директория для сохранения результатов (по умолчанию: "output")
--model (-m) - Идентификатор модели для использования
--context-window (-c) - Количество предыдущих страниц для контекста (по умолчанию: 2)
--poppler-path (-p) - Путь к исполняемым файлам Poppler
--debug - Включить режим отладки
--translate (-tr) - Включить перевод обработанного даташита
--target-language (-tl) - Целевой язык для перевода
--start-page (-sp) - Первая страница для обработки (нумерация с 1)
--end-page (-ep) - Последняя страница для обработки (нумерация с 1)
```

### Выбор диапазона страниц

Парсер позволяет обрабатывать только определенные страницы из PDF документа:

- **Выборочная обработка**: Укажите диапазон страниц для извлечения и обработки
- **Гибкий диапазон**: Используйте начальную страницу, конечную страницу или обе для определения диапазона
- **Именование выходных файлов**: Сгенерированные файлы включают диапазон страниц в своих именах (например, `datasheet_p5-10_full.md`)
- **Эффективность ресурсов**: Уменьшает время обработки и затраты на API при работе с большими документами

Примеры использования с выбором диапазона страниц:
```bash
# Обработать только страницы 5-10
python datasheet_parser.py datasheet.pdf --start-page 5 --end-page 10

# Обработать от страницы 3 до конца
python datasheet_parser.py datasheet.pdf --start-page 3

# Обработать от начала до страницы 15
python datasheet_parser.py datasheet.pdf --end-page 15

# Комбинировать с переводом
python datasheet_parser.py datasheet.pdf --start-page 5 --end-page 10 --translate --target-language "French"
```

### Функция перевода

Парсер включает мощную функцию перевода, которая может конвертировать техническую документацию на различные языки, сохраняя техническую точность и форматирование:

- **Прямой перевод**: Контент переводится непосредственно в процессе извлечения
- **Сохранение форматирования**: Поддерживает все элементы Markdown, таблицы, списки и структурные элементы
- **Техническая точность**: Сохраняет единицы измерения, формулы, номера моделей и технические характеристики
- **Поддержка языков**: Работает с любым целевым языком, поддерживаемым моделью ИИ
- **Именование файлов**: Выходные файлы включают целевой язык в своих именах (например, `datasheet_russian_full.md`)

Примеры использования с переводом:
```bash
# Базовый перевод
python datasheet_parser.py datasheet.pdf --translate --target-language "French"

# Перевод с указанием модели и директории вывода
python datasheet_parser.py datasheet.pdf \
    --translate --target-language "Spanish" \
    --model "gpt-4o" \
    --output "spanish_docs"
```

## Структура проекта

- `datasheet_parser.py` - основной скрипт для обработки PDF документов
- `pdf_utils.py` - утилиты для работы с PDF файлами
- `api_client.py` - клиент для взаимодействия с OpenAI API
- `markdown_generator.py` - утилиты для создания Markdown файлов
- `prompts.py` - системные сообщения и инструкции для модели ИИ